image: python:3.8

before_script:
        - python3 -V
        - python3 -m venv .
        - source bin/activate
        - pip3 install wheel

test:
        stage: test
        script:
                - python3 setup.py test
build:
        stage: build
        script:
                - python3 setup.py sdist bdist_wheel
        rules:
                - if: '$CI_COMMIT_BRANCH == "release"'
test birdlib:
        stage: test birdlib
        script:
                - cd bird-browser
                - python3 setup.py test
build birdlib:
        stage: build birdlib
        script:
                - python3 setup.py sdist bdist_wheel
        rules:
                - if: '$CI_COMMIT_BRANCH == "release"'
